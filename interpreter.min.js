function LessEqualRelationExpression(){}LessEqualRelationExpression.prototype=new BinaryExpression();LessEqualRelationExpression.prototype.accept=function(a){a.visitLessEqualRelation(this)};function NotEqualRelationExpression(){}NotEqualRelationExpression.prototype=new BinaryExpression();NotEqualRelationExpression.prototype.accept=function(a){a.visitNotEqualRelation(this)};function NullExpression(){}NullExpression.prototype=new Expression();NullExpression.prototype.accept=function(a){a.visitNull(this)};function TimesExpression(){}TimesExpression.prototype=new BinaryExpression();TimesExpression.prototype.accept=function(a){a.visitTimes(this)};function PlusExpression(){}PlusExpression.prototype=new BinaryExpression();PlusExpression.prototype.accept=function(a){a.visitPlus(this)};function GreaterRelationExpression(){}GreaterRelationExpression.prototype=new BinaryExpression();GreaterRelationExpression.prototype.accept=function(a){a.visitGreaterRelation(this)};function NegationExpression(){}NegationExpression.prototype=new BinaryExpression();NegationExpression.prototype.accept=function(a){a.visitNegation(this)};function EqualRelationExpression(){}EqualRelationExpression.prototype=new BinaryExpression();EqualRelationExpression.prototype.accept=function(a){a.visitEqualRelation(this)};function PositiveExpression(){}PositiveExpression.prototype=new UnaryExpression();PositiveExpression.prototype.accept=function(a){a.visitPositive(this)};function SubscriptExpression(){}SubscriptExpression.prototype=new BinaryExpression();SubscriptExpression.prototype.accept=function(a){a.visitSubscript(this)};function FactorialExpression(){}FactorialExpression.prototype=new UnaryExpression();FactorialExpression.prototype.accept=function(a){a.visitFactorial(this)};function MinusExpression(){}MinusExpression.prototype=new BinaryExpression();MinusExpression.prototype.accept=function(a){a.visitMinus(this)};function ConstantExpression(a){this.name=a}ConstantExpression.prototype=new Expression();ConstantExpression.prototype.accept=function(a){a.visitConstant(this)};function Expression(){this.parent=null}Expression.prototype.accept=function(a){console.log("Expression.accept() not implemented")};function NumberExpression(a){this.value=a}NumberExpression.prototype=new Expression();NumberExpression.prototype.accept=function(a){a.visitNumber(this)};function DivideExpression(){}DivideExpression.prototype=new BinaryExpression();DivideExpression.prototype.accept=function(a){a.visitDivide(this)};function VariableExpression(a){this.name=a}VariableExpression.prototype=new Expression();VariableExpression.prototype.accept=function(a){a.visitVariable(this)};function UnaryExpression(){this.child=null}UnaryExpression.prototype=new Expression();function LessRelationExpression(){}LessRelationExpression.prototype=new BinaryExpression();LessRelationExpression.prototype.accept=function(a){a.visitLessRelation(this)};function ParenthesesExpression(){}ParenthesesExpression.prototype=new UnaryExpression();ParenthesesExpression.prototype.accept=function(a){a.visitParentheses(this)};function GreaterEqualRelationExpression(){}GreaterEqualRelationExpression.prototype=new BinaryExpression();GreaterEqualRelationExpression.prototype.accept=function(a){a.visitGreaterEqualRelation(this)};function BinaryExpression(){this.left=null;this.right=null}BinaryExpression.prototype=new Expression();function ExponentExpression(){}ExponentExpression.prototype=new BinaryExpression;ExponentExpression.prototype.accept=function(a){a.visitExponent(this)};function ExpressionVisitor(){}ExpressionVisitor.prototype.visitLessRelation=function(a){console.log("visitLessRelation not implemented")};ExpressionVisitor.prototype.visitLessEqualRelation=function(a){console.log("visitLessEqualRelation not implemented")};ExpressionVisitor.prototype.visitEqualRelation=function(a){console.log("visitEqualRelation not implemented")};ExpressionVisitor.prototype.visitNotEqualRelation=function(a){console.log("visitNotEqualRelation not implemented")};ExpressionVisitor.prototype.visitGreaterEqualRelation=function(a){console.log("visitGreaterEqualRelation not implemented")};ExpressionVisitor.prototype.visitGreaterRelation=function(a){console.log("visitGreaterRelation not implemented")};ExpressionVisitor.prototype.visitPlus=function(a){console.log("visitPlus not implemented")};ExpressionVisitor.prototype.visitMinus=function(a){console.log("visitMinus not implemented")};ExpressionVisitor.prototype.visitTimes=function(a){console.log("visitTimes not implemented")};ExpressionVisitor.prototype.visitDivide=function(a){console.log("visitDivide not implemented")};ExpressionVisitor.prototype.visitExponent=function(a){console.log("visitExponent not implemented")};ExpressionVisitor.prototype.visitSubscript=function(a){console.log("visitSubscript not implemented")};ExpressionVisitor.prototype.visitParentheses=function(a){console.log("visitParentheses not implemented")};ExpressionVisitor.prototype.visitNegation=function(a){console.log("visitNegation not implemented")};ExpressionVisitor.prototype.visitPositive=function(a){console.log("visitPositive not implemented")};ExpressionVisitor.prototype.visitFactorial=function(a){console.log("visitFactorial not implemented")};ExpressionVisitor.prototype.visitNumber=function(a){console.log("visitNumber not implemented")};ExpressionVisitor.prototype.visitVariable=function(a){console.log("visitVariable not implemented")};ExpressionVisitor.prototype.visitConstant=function(a){console.log("visitConstant not implemented")};ExpressionVisitor.prototype.visitNull=function(a){console.log("visitNull not implemented")};function LatexTranslator(){this.latex="";this.specialVarNames={alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",Gamma:"\\Gamma",delta:"\\delta",Delta:"\\Delta",epsilon:"\\varepsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",Theta:"\\Theta",kappa:"\\kappa",lambda:"\\lambda",Lambda:"\\Lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",Xi:"\\Xi",omicron:"o",pi:"\\pi",Pi:"\\Pi",rho:"\\rho",sigma:"\\sigma",Sigma:"\\Sigma",tau:"\\tau",upsilon:"\\upsilon",Upsilon:"\\Upsilon",phi:"\\varphi",Phi:"\\Phi",chi:"\\chi",psi:"\\psi",Psi:"\\Psi",omega:"\\omega",Omega:"\\Omega"};this.constants={pi:"\\pi",p:"\\pi",i:"i",e:"\\mathrm{e}",vi:"\\hat\\imath",vj:"\\hat\\jmath",vk:"\\hat{k}",v0:"\\vec{0}",one:"\\mathbf{1}",zero:"\\mathbf{0}",infinity:"\\infty","null":"\\emptyset",gamma:"\\gamma",N:"\\mathbb{N}",Z:"\\mathbb{Z}",Q:"\\mathbb{Q}",R:"\\mathbb{R}",C:"\\mathbb{C}",}}LatexTranslator.prototype=new ExpressionVisitor();LatexTranslator.prototype.visitPlus=function(a){a.left.accept(this);this.latex+="+";a.right.accept(this)};LatexTranslator.prototype.visitMinus=function(a){a.left.accept(this);this.latex+="-";a.right.accept(this)};LatexTranslator.prototype.visitTimes=function(a){var b="{\\cdot}";if(a.left instanceof VariableExpression||a.right instanceof VariableExpression||a.left instanceof ConstantExpression||a.right instanceof ConstantExpression||a.right instanceof ParenthesesExpression){b=""}a.left.accept(this);this.latex+=b;a.right.accept(this)};LatexTranslator.prototype.visitDivide=function(a){this.latex+="\\frac{";a.left.accept(this);this.latex+="}{";a.right.accept(this);this.latex+="}"};LatexTranslator.prototype.visitExponent=function(a){a.left.accept(this);this.latex+="^{";a.right.accept(this);this.latex+="}"};LatexTranslator.prototype.visitSubscript=function(a){a.left.accept(this);this.latex+="_{";a.right.accept(this);this.latex+="}"};LatexTranslator.prototype.visitParentheses=function(a){if(a.parent instanceof DivideExpression){a.child.accept(this)}else{this.latex+="\\left(";a.child.accept(this);this.latex+="\\right)"}};LatexTranslator.prototype.visitNegation=function(a){this.latex+="-";a.child.accept(this)};LatexTranslator.prototype.visitNumber=function(a){this.latex+=a.value+""};LatexTranslator.prototype.visitVariable=function(a){if(undefined!==this.specialVarNames[a.name]){this.latex+="{"+this.specialVarNames[a.name]+"}"}else{this.latex+=a.name}};LatexTranslator.prototype.visitConstant=function(a){if(undefined!==this.constants[a.name]){this.latex+="{"+this.constants[a.name]+"}"}else{this.latex+="\\#"+a.name}};function ExpressionBuilder(){}ExpressionBuilder.prototype=new ExpressionBuilderInterface();function buildUnaryExpression(a,b){b.parent=a;a.child=b;return a}function buildBinaryExpression(c,b,a){b.parent=c;a.parent=c;c.left=b;c.right=a;return c}ExpressionBuilder.prototype.newLessRelation=function(b,a){return buildBinaryExpression(new LessRelationExpression(),b,a)};ExpressionBuilder.prototype.newLessEqualRelation=function(b,a){return buildBinaryExpression(new LessEqualRelationExpression(),b,a)};ExpressionBuilder.prototype.newEqualRelation=function(b,a){return buildBinaryExpression(new EqualRelationExpression(),b,a)};ExpressionBuilder.prototype.newNotEqualRelation=function(b,a){return buildBinaryExpression(new NotEqualRelationExpression(),b,a)};ExpressionBuilder.prototype.newGreaterEqualRelation=function(b,a){return buildBinaryExpression(new GreaterEqualRelationExpression(),b,a)};ExpressionBuilder.prototype.newGreaterRelation=function(b,a){return buildBinaryExpression(new GreaterRelationExpression(),b,a)};ExpressionBuilder.prototype.newPlus=function(b,a){return buildBinaryExpression(new PlusExpression(),b,a)};ExpressionBuilder.prototype.newMinus=function(b,a){return buildBinaryExpression(new MinusExpression(),b,a)};ExpressionBuilder.prototype.newTimes=function(b,a){return buildBinaryExpression(new TimesExpression(),b,a)};ExpressionBuilder.prototype.newDivide=function(b,a){return buildBinaryExpression(new DivideExpression(),b,a)};ExpressionBuilder.prototype.newExponent=function(b,a){return buildBinaryExpression(new ExponentExpression(),b,a)};ExpressionBuilder.prototype.newSubscript=function(b,a){return buildBinaryExpression(new SubscriptExpression(),b,a)};ExpressionBuilder.prototype.newParentheses=function(a){return buildUnaryExpression(new ParenthesesExpression(),a)};ExpressionBuilder.prototype.newNegation=function(a){return buildUnaryExpression(new NegationExpression(),a)};ExpressionBuilder.prototype.newPositive=function(a){return buildUnaryExpression(new PositiveExpression(),a)};ExpressionBuilder.prototype.newFactorial=function(a){return buildUnaryExpression(new FactorialExpression(),a)};ExpressionBuilder.prototype.newNumber=function(a){return new NumberExpression(a)};ExpressionBuilder.prototype.newVariable=function(a){return new VariableExpression(a)};ExpressionBuilder.prototype.newConstant=function(a){return new ConstantExpression(a)};ExpressionBuilder.prototype.newNull=function(){return new NullExpression()};function ExpressionBuilderInterface(){}ExpressionBuilderInterface.prototype.newLessRelation=function(b,a){console.log("ExpressionBuilderInterface.newLessRelation() is not implemented")};ExpressionBuilderInterface.prototype.newLessEqualRelation=function(b,a){console.log("ExpressionBuilderInterface.newLessEqualRelation() is not implemented")};ExpressionBuilderInterface.prototype.newEqualRelation=function(b,a){console.log("ExpressionBuilderInterface.newEqualRelation() is not implemented")};ExpressionBuilderInterface.prototype.newNotEqualRelation=function(b,a){console.log("ExpressionBuilderInterface.newNotEqualRelation() is not implemented")};ExpressionBuilderInterface.prototype.newGreaterEqualRelation=function(b,a){console.log("ExpressionBuilderInterface.newGreaterEqualRelation() is not implemented")};ExpressionBuilderInterface.prototype.newGreaterRelation=function(b,a){console.log("ExpressionBuilderInterface.newGreaterRelation() is not implemented")};ExpressionBuilderInterface.prototype.newPlus=function(b,a){console.log("ExpressionBuilderInterface.newPlus() is not implemented")};ExpressionBuilderInterface.prototype.newMinus=function(b,a){console.log("ExpressionBuilderInterface.newMinus() is not implemented")};ExpressionBuilderInterface.prototype.newTimes=function(b,a){console.log("ExpressionBuilderInterface.newTimes() is not implemented")};ExpressionBuilderInterface.prototype.newDivide=function(b,a){console.log("ExpressionBuilderInterface.newDivide() is not implemented")};ExpressionBuilderInterface.prototype.newExponent=function(b,a){console.log("ExpressionBuilderInterface.newExponent() is not implemented")};ExpressionBuilderInterface.prototype.newSubscript=function(b,a){console.log("ExpressionBuilderInterface.newSubscript() is not implemented")};ExpressionBuilderInterface.prototype.newParentheses=function(a){console.log("ExpressionBuilderInterface.newParentheses() is not implemented")};ExpressionBuilderInterface.prototype.newNegation=function(a){console.log("ExpressionBuilderInterface.newNegation() is not implemented")};ExpressionBuilderInterface.prototype.newPositive=function(a){console.log("ExpressionBuilderInterface.newPositive() is not implemented")};ExpressionBuilderInterface.prototype.newFactorial=function(a){console.log("ExpressionBuilderInterface.newFactorial() is not implemented")};ExpressionBuilderInterface.prototype.newNumber=function(a){console.log("ExpressionBuilderInterface.newNumber() is not implemented")};ExpressionBuilderInterface.prototype.newVariable=function(a){console.log("ExpressionBuilderInterface.newVariable() is not implemented")};ExpressionBuilderInterface.prototype.newConstant=function(a){console.log("ExpressionBuilderInterface.newConstant() is not implemented")};ExpressionBuilderInterface.prototype.newNull=function(){console.log("ExpressionBuilderInterface.newNull() is not implemented")};function Parser(a){this.builder=a;this.parseTree=null}Parser.prototype.parse=function(a){this.tokens=a;this.parseTree=this.parseSum()};Parser.prototype.parseSum=function(){var b=this.parseTerm();var a=this.tokens.getNext();switch(a.type){case TokenType.PLUS:return this.builder.newPlus(b,this.parseSum());case TokenType.MINUS:return this.builder.newMinus(b,this.parseSum());default:this.tokens.putBack(a);return b}};Parser.prototype.parseTerm=function(){var b=this.parseNegation();var a=this.tokens.getNext();switch(a.type){case TokenType.TIMES:return this.builder.newTimes(b,this.parseTerm());case TokenType.DIVIDE:return this.builder.newDivide(b,this.parseTerm());default:this.tokens.putBack(a);return b}};Parser.prototype.parseNegation=function(){var a=this.tokens.getNext();if(a.type==TokenType.MINUS){return this.bulder.newNegation(this.parseFactor())}else{this.tokens.putBack(a);return this.parseFactor()}};Parser.prototype.parseFactor=function(){var b=this.parsePrimary();var a=this.tokens.getNext();switch(a.type){case TokenType.CARET:return this.builder.newExponent(b,this.parseNegation());case TokenType.UNDERSCORE:return this.builder.newSubscript(b,this.parseNegation());default:this.tokens.putBack(a);return b}};Parser.prototype.parsePrimary=function(){var b=this.tokens.getNext();var a;switch(b.type){case TokenType.LPAREN:a=this.builder.newParentheses(this.parseSum());if(this.tokens.getNext().type!=TokenType.RPAREN){throw"Expected "+TokenType.RPAREN+" token."}return a;case TokenType.NUMBER:return this.builder.newNumber(parseFloat(b.value));case TokenType.CONSTANT:return this.builder.newConstant(b.value);case TokenType.VARIABLE:return this.builder.newVariable(b.value);default:this.tokens.putBack(b);throw"Expected primary token"}};function Token(a,b){this.type=b?a:Token.typeOf(a);this.value=b?b:a}Token.Type={UNKNOWN:0,PLUS:1,MINUS:2,TIMES:3,DIVIDE:4,CARET:5,UNDERSCORE:6,LPAREN:7,RPAREN:8,BANG:9,DOT:10,CROSS:11,COMPOSITION:12,VECTORIZE:13,GREATER_EQUAL:14,GREATER_THAN:15,EQUAL:16,NOT_EQUAL:17,LESS_THAN:18,LESS_EQUAL:19,NUMBER:20,CONSTANT:21,VARIABLE:22,};Token.typeMap={"+":Token.Type.PLUS,"-":Token.Type.MINUS,"*":Token.Type.TIMES,"/":Token.Type.DIVIDE,"^":Token.Type.CARET,_:Token.Type.UNDERSCORE,"(":Token.Type.LPAREN,")":Token.Type.RPAREN,"!":Token.Type.BANG,"&.":Token.Type.DOT,"&x":Token.Type.CROSS,"&o":Token.Type.COMPOSITION,"&v":Token.Type.VECTORIZE,">=":Token.Type.GREATER_EQUAL,">":Token.Type.GREATER_THAN,"=":Token.Type.EQUAL,"!=":Token.Type.NOT_EQUAL,"<>":Token.Type.NOT_EQUAL,"<":Token.Type.LESS_THAN,"<=":Token.Type.LESS_EQUAL};Token.typeOf=function(a){if(undefined!==Token.typeMap[a]){return Token.typeMap[a]}else{return Token.Type.UNKNOWN}};Token.getMultiChars=function(){var b={};for(var a in this.typeMap){if(a.length>1){b[a]=this.typeMap[a]}}return b};function Tokenizer(){var a="",g=[],e=0,f=false;this.getIterator=function(){if(!f){throw"Nothing has been tokenized!"}return new TokenIterator(g)};this.reset=function(){a="";e=0;g=[];f=false};function d(){var l=1,m=Token.getMultiChars().s,h;while(m.length>0){l++;if(e+l>=a.length){break}s=a.substring(e,e+l);h=[];for(var j in m){if(j.substring(0,s.length)===s){h.push(j)}}m=h}if(l==1){l++}g.push(new Token(a.substring(e,e+l-1)));e+=l-1}function b(){var h=e;while(e<a.length&&a[e].match(/[\d\.]/)){e++}g.push(new Token(Token.Type.NUMBER,a.substring(h,e)))}function c(){var h=Token.Type.VARIABLE,i;if(a[e]=="#"){h=Token.Type.CONSTANT;e++}if(a[e].match(/[a-zA-Z]/)){var j=e;while(e<a.length&&a[e].match(/[a-zA-Z]/)){e++}i=a.substring(j,e)}else{h=Token.Type.UNKNOWN;i=this.input[this.currPos];e++}g.push(new Token(h,i))}this.tokenize=function(h){this.reset();h=h;var i;while(e<h.length){i=h[e];if(i.match(/[\*\/\+\-\^\_\(\)\&\!\=\<\>]/)){d()}else{if(i.match(/[\d\.]/)){b()}else{c()}}}f=true}}function TokenIterator(b){var a=0;this.first=function(){a=0};this.next=function(){a++};this.prev=function(){a--};this.getCurrent=function(){return b.get(a)};this.isDone=function(){return(a>=b.length)}};